

  <h3 mat-dialog-title>    
      <span>Agregar Producto</span>
  </h3>
  <form [formGroup]="productoForm" (ngSubmit)="onSubmit()">
    <div class="contenedor-principal">
      <div class="contenedor-secundario">
        <div class="contenedor-img-consola">
          <img [src]="ImagePath" alt="imagen-consola" class="imagen-consola">
        </div>
        <div class="contendor-form">
          <mat-dialog-content class="mat-typography">
            <h3>Ingresa detalles del producto a ingresar</h3>
              <!--Codigo Consola  -->
            <!-- FABRICANTE -->
          <mat-form-field class="input-form-prod">
            <mat-label>Fabricante</mat-label>
            <mat-select formControlName ="Fabricante" name="Fabricante">             
                <mat-option *ngFor="let est of selectedFabricante" [value]="est.IdFabricantePK" >{{est.NombreFabricante}} </mat-option>            
            </mat-select> 
          </mat-form-field>
          <!-- CATEGORIA -->
          <mat-form-field class="input-form-prod">
            <mat-label>Categoria</mat-label>
            <mat-select formControlName ="Cate" name="Cate">             
                <mat-option *ngFor="let est of selectedCategoriaProducto" [value]="est.IdCategoriaPK" >{{est.NombreCategoria}} </mat-option>            
            </mat-select> 
          </mat-form-field> 
          <!-- SUBCATEGORIA -->
          <mat-form-field class="input-form-prod">
            <mat-label>Modelo</mat-label>
            <mat-select formControlName ="SubCategoria" name="SubCategoria">             
                <mat-option *ngFor="let est of selectedSubCategoriaProducto" [value]="est.IdSubcategoria" >{{est.NombreSubCategoria}} </mat-option>            
            </mat-select> 
          </mat-form-field>
           <!--Numero de serie Consola  -->
           <mat-form-field class="input-form-prod">
              <mat-label>Numero de serie</mat-label>
              <input formControlName="NumeroSerie" name="NumeroSerie" matInput cdkFocusInitial maxlength="100">
              <mat-error *ngIf="productoForm.get('NumeroSerie')?.hasError('maxlength')">
                El número de serie no puede exceder los 100 caracteres.
              </mat-error>
              </mat-form-field>    
              <!--Color Consola  -->
            <mat-form-field class="input-form-prod">
              <mat-label>Color</mat-label>
              <input formControlName="ColorConsola" name="ColorConsola" matInput cdkFocusInitial maxlength="100">
              <mat-error *ngIf="productoForm.get('ColorConsola')?.hasError('maxlength')">
                El color no puede exceder los 100 caracteres.
              </mat-error>
            </mat-form-field>
              <!--Estado Consola  -->
            <mat-form-field class="input-form-prod">
              <mat-label>Estado</mat-label>
              <mat-select formControlName = "EstadoConsola" name="est">             
                  <mat-option *ngFor="let est of selectedEstado" [value]="est.CodigoEstado">{{est.DescripcionEstado}} </mat-option>            
              </mat-select> 
            </mat-form-field>
            <!--Precio Base Consola  -->
            <mat-form-field class="input-form-prod">
              <mat-label>Precio Base</mat-label>
              <input formControlName="PrecioBase" name="PrecioBase" matInput 
                     type="number" step="0.01" placeholder="Ej: 150.50">
              <mat-error *ngIf="productoForm.get('PrecioBase')?.hasError('required')">
                El precio es obligatorio.
              </mat-error>
              <mat-error *ngIf="productoForm.get('PrecioBase')?.hasError('pattern') || productoForm.get('PrecioBase')?.hasError('max')">
                Precio inválido. Use hasta 4 dígitos y 2 decimales (ej: 1250.99).
              </mat-error>
            </mat-form-field>
            <!--Precio Base Consola  -->
            <!-- <mat-form-field class="input-form-prod">
              <mat-label>Moneda</mat-label>
              <textarea formControlName = "Moneda" name="Moneda" matInput></textarea>
            </mat-form-field>                -->
            <!-- Hack o Stock -->
            <mat-form-field class="input-form-prod">
              <mat-label>Hack?</mat-label>
              <mat-select formControlName = "HackConsola">
                <mat-option value=0>Stock</mat-option>
                <mat-option value=1>Hack</mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field class="input-form-prod">
              <mat-label>Accesorios</mat-label>
              <mat-chip-grid #chipGrid aria-label="Enter keywords" formControlName = "Accesorios">
                @for (keyword of keywords(); track keyword) {
                  <mat-chip-row (removed)="removeKeyword(keyword)">
                    {{keyword}}
                    <button matChipRemove aria-label="'remove ' + keyword">
                      <mat-icon>cancel</mat-icon>
                    </button>
                  </mat-chip-row>
                }
              </mat-chip-grid>
              <input
                placeholder="Agrega accesorios..."
                [matChipInputFor]="chipGrid"
                (matChipInputTokenEnd)="add($event)"
              />
              <mat-error *ngIf="productoForm.get('Accesorios')?.hasError('totalLengthExceeded')">
                La lista de accesorios es muy larga (máximo 500 caracteres en total).
              </mat-error>
          </mat-form-field>
          <mat-form-field class="example-form-field">
            <mat-label>Tareas a realizar</mat-label>
            <mat-chip-grid #reactiveChipGrid aria-label="Enter reactive form keywords" formControlName ="TodoList">
            @for (keyword of todolistKeywords(); track keyword) {
              <mat-chip-row (removed)="removeReactiveKeyword(keyword)">
                {{keyword}}
              <button matChipRemove aria-label="'remove reactive form' + keyword">
                <mat-icon>cancel</mat-icon>
              </button>
              </mat-chip-row>
            }
            </mat-chip-grid>
            <input
              placeholder="New keyword..."
              [matChipInputFor]="reactiveChipGrid"
              (matChipInputTokenEnd)="addReactiveKeyword($event)"
            />
          </mat-form-field>
          
          </mat-dialog-content>
          
        </div>  
      </div>
      <!-- Comentarios -->
      <div class="contenedor-comentario">
        <h3>Comentarios</h3>
        <mat-form-field class="example-full-width"  >
          <mat-label>Describe el estado del producto</mat-label>
          <textarea matInput formControlName = "ComentarioConsola" placeholder="Pantalla rota, para repuesto, etc..." maxlength="10000"></textarea>
          <mat-error *ngIf="productoForm.get('ComentarioConsola')?.hasError('maxlength')">
            El comentario no puede exceder los 10,000 caracteres.
          </mat-error>
        </mat-form-field>
      </div>  
    </div>
    <mat-dialog-actions align="end">
      <button mat-button mat-dialog-close>Cancelar</button>
      <button mat-button type="submit" [mat-dialog-close]="true" cdkFocusInitial class="btn btn-secundary" color="primary" (Click)="onSubmit()" [disabled]="!productoForm.valid">Ingresar</button>
    </mat-dialog-actions>
  </form>
