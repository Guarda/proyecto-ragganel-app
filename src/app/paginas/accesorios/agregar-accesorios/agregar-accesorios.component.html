

<h3 mat-dialog-title>    
    <span>Agregar Accesorio</span>
</h3>
<form [formGroup]="accesorioForm" (ngSubmit)="onSubmit()">
  <div class="contenedor-principal">
    <div class="contenedor-secundario">
      <div class="contenedor-img-consola">
        <img [src]="ImagePath" alt="imagen-consola" class="imagen-consola">
      </div>
      <div class="contendor-form">
        <mat-dialog-content class="mat-typography">
          <h3>Ingresa detalles del producto a ingresar</h3>
            <!--Codigo Consola  -->
          <!-- FABRICANTE -->
        <mat-form-field class="input-form-prod">
          <mat-label>Fabricante</mat-label>
          <mat-select formControlName ="FabricanteAccesorio" name="FabricanteAccesorio">             
              <mat-option *ngFor="let est of selectedFabricanteAccesorio" [value]="est.IdFabricanteAccesorioPK" >{{est.NombreFabricanteAccesorio}} </mat-option>            
          </mat-select> 
        </mat-form-field>
        <!-- CATEGORIA -->
        <mat-form-field class="input-form-prod">
          <mat-label>Categoria</mat-label>
          <mat-select formControlName ="CateAccesorio" name="CateAccesorio">             
              <mat-option *ngFor="let est of selectedCategoriaAccesorio" [value]="est.IdCategoriaAccesorioPK" >{{est.NombreCategoriaAccesorio}} </mat-option>            
          </mat-select> 
        </mat-form-field> 
        <!-- SUBCATEGORIA -->
        <mat-form-field class="input-form-prod">
          <mat-label>Modelo</mat-label>
          <mat-select formControlName ="SubCategoriaAccesorio" name="SubCategoriaAccesorio">             
              <mat-option *ngFor="let est of selectedSubCategoriaAccesorio" [value]="est.IdSubcategoriaAccesorio" >{{est.NombreSubcategoriaAccesorio}} </mat-option>            
          </mat-select> 
        </mat-form-field>
         <!--Numero de serie Consola  -->
         <mat-form-field class="input-form-prod">
          <mat-label>Numero de serie</mat-label>
          <input formControlName = "NumeroSerie" name="NumeroSerie" matInput cdkFocusInitial maxlength="100">
          <mat-error *ngIf="accesorioForm.get('NumeroSerie')?.hasError('maxlength')">
            El número de serie no puede exceder los 100 caracteres.
          </mat-error>
          </mat-form-field>    
            <!--Color Consola  -->
          <mat-form-field class="input-form-prod">
            <mat-label>Color</mat-label>
            <input formControlName = "ColorAccesorio" name="ColorAccesorio" matInput cdkFocusInitial maxlength="100">
            <mat-error *ngIf="accesorioForm.get('ColorAccesorio')?.hasError('maxlength')">
              El color no puede exceder los 100 caracteres.
            </mat-error>
          </mat-form-field>
            <!--Estado Consola  -->
          <mat-form-field class="input-form-prod">
            <mat-label>Estado</mat-label>
            <mat-select formControlName = "EstadoAccesorio" name="est">             
                <mat-option *ngFor="let est of selectedEstado" [value]="est.CodigoEstado">{{est.DescripcionEstado}} </mat-option>            
            </mat-select> 
          </mat-form-field>
          <!--Precio Base Consola  -->
          <mat-form-field class="input-form-prod">
            <mat-label>Precio Base</mat-label>
            <input formControlName = "PrecioBase" name="PrecioBase" matInput 
                   type="number" step="0.01" placeholder="Ej: 150.50">
            <mat-error *ngIf="accesorioForm.get('PrecioBase')?.hasError('required')">
              El precio es obligatorio.
            </mat-error>
            <mat-error *ngIf="accesorioForm.get('PrecioBase')?.hasError('pattern') || accesorioForm.get('PrecioBase')?.hasError('max')">
              Precio inválido. Use hasta 4 dígitos y 2 decimales (ej: 1250.99).
            </mat-error>
          </mat-form-field>        
          
          <!-- Productos Compatibles -->
          <mat-form-field class="input-form-prod">
            <mat-label>Productos Compatibles</mat-label>
            <mat-chip-grid #chipGrid aria-label="Enter keywords" formControlName = "ProductosCompatibles">
              @for (keyword of keywords(); track keyword) {
                <mat-chip-row (removed)="removeKeyword(keyword)">
                  {{keyword}}
                  <button matChipRemove aria-label="'remove ' + keyword">
                    <mat-icon>cancel</mat-icon>
                  </button>
                </mat-chip-row>
              }
            </mat-chip-grid>
            <input
              placeholder="Agrega Productos Compatibles..."
              [matChipInputFor]="chipGrid"
              (matChipInputTokenEnd)="add($event)"
            />
            <mat-error *ngIf="accesorioForm.get('ProductosCompatibles')?.hasError('totalLengthExceeded')">
              La lista de productos es muy larga (máximo 500 caracteres en total).
            </mat-error>
        </mat-form-field>
          <!--Tareas -->         
        <mat-form-field class="example-form-field">
          <mat-label>Tareas a realizar</mat-label>
          <mat-chip-grid #reactiveChipGrid aria-label="Enter reactive form keywords" formControlName ="TodoList">
          @for (keyword of todolistKeywords(); track keyword) {
            <mat-chip-row (removed)="removeReactiveKeyword(keyword)">
              {{keyword}}
            <button matChipRemove aria-label="'remove reactive form' + keyword">
              <mat-icon>cancel</mat-icon>
            </button>
            </mat-chip-row>
          }
          </mat-chip-grid>
          <input
            placeholder="New keyword..."
            [matChipInputFor]="reactiveChipGrid"
            (matChipInputTokenEnd)="addReactiveKeyword($event)"
          />
        </mat-form-field>
        
        </mat-dialog-content>
        
      </div>  
    </div>
    <!-- Comentarios -->
    <div class="contenedor-comentario">
      <h3>Comentarios</h3>
      <mat-form-field class="example-full-width"  >
        <mat-label>Describe el estado del producto</mat-label>
        <textarea matInput formControlName = "ComentarioAccesorio" placeholder="Pantalla rota, para repuesto, etc..." maxlength="10000"></textarea>
        <mat-error *ngIf="accesorioForm.get('ComentarioAccesorio')?.hasError('maxlength')">
          El comentario no puede exceder los 10,000 caracteres.
        </mat-error>
      </mat-form-field>
    </div>  
  </div>
  <mat-dialog-actions align="end">
    <button mat-button mat-dialog-close>Cancelar</button>
    <button mat-button type="submit" [mat-dialog-close]="true" cdkFocusInitial class="btn btn-secundary" color="primary" (Click)="onSubmit()" [disabled]="!accesorioForm.valid">Ingresar</button>
  </mat-dialog-actions>
</form>
