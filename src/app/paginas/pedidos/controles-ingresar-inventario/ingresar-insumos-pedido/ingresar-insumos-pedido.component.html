<mat-card [formGroup]="form">
  <mat-card-header class="compact-header">
    <mat-card-title>{{ articulo.NombreFabricante }} - {{ articulo.NombreSubCategoria }}</mat-card-title>
    <mat-card-subtitle>Artículo #{{ stepperIndex + 1 }}</mat-card-subtitle>
  </mat-card-header>

  <mat-card-content class="card-layout-container">

    <div class="image-container">
      <img [src]="ImagePath" alt="Imagen de {{ articulo.NombreSubCategoria }}" class="articulo-imagen">
    </div>

    <div class="form-grid">

      <!-- <mat-form-field appearance="fill">
        <mat-label>Fabricante</mat-label>
        <mat-select formControlName="FabricanteInsumo">
          <mat-option *ngFor="let fab of selectedFabricanteInsumos" [value]="fab.IdFabricanteInsumosPK">{{fab.NombreFabricanteInsumos}}</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Categoría</mat-label>
        <mat-select formControlName="CateInsumo">
          <mat-option *ngFor="let cat of selectedCategoriaInsumos" [value]="cat.IdCategoriaInsumosPK">{{cat.NombreCategoriaInsumos}}</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Modelo</mat-label>
        <mat-select formControlName="SubCategoriaInsumo">
          <mat-option *ngFor="let sub of selectedSubcategoriaInsumos" [value]="sub.IdSubcategoriaInsumos">{{sub.NombreSubcategoriaInsumos}}</mat-option>
        </mat-select>
      </mat-form-field> -->

      <mat-form-field appearance="fill">
        <mat-label>Estado</mat-label>
        <mat-select formControlName="EstadoInsumo">
          <mat-option *ngFor="let est of selectedEstado" [value]="est.CodigoEstado">{{est.DescripcionEstado}}</mat-option>
        </mat-select>
        <mat-error *ngIf="form.get('EstadoInsumo')?.hasError('required')">
          El estado es requerido.
        </mat-error>
      </mat-form-field>
      
      <mat-form-field appearance="fill">
        <mat-label>Número de Serie (Opcional)</mat-label>
        <input matInput formControlName="NumeroSerie">
        <mat-error *ngIf="form.get('NumeroSerie')?.hasError('maxlength')">
          Máximo 100 caracteres.
        </mat-error>
      </mat-form-field>
      
      <mat-form-field appearance="fill">
        <mat-label>Número de Serie (Opcional)</mat-label>
        <input matInput formControlName="NumeroSerie">
        <mat-error *ngIf="form.get('NumeroSerie')?.hasError('maxlength')">
          Máximo 100 caracteres.
        </mat-error>
      </mat-form-field>
      
      <mat-form-field appearance="fill">
        <mat-label>Cantidad</mat-label>
        <input matInput type="number" formControlName="Cantidad">
        <mat-error *ngIf="form.get('Cantidad')?.hasError('required')">
          Requerido.
        </mat-error>
        <mat-error *ngIf="form.get('Cantidad')?.hasError('pattern') || form.get('Cantidad')?.hasError('min')">
          Debe ser un número entero mayor a 0.
        </mat-error>
      </mat-form-field>
      
      <mat-form-field appearance="fill">
        <mat-label>Stock Mínimo</mat-label>
        <input matInput type="number" formControlName="StockMinimo">
        <mat-error *ngIf="form.get('StockMinimo')?.hasError('required')">
          Requerido.
        </mat-error>
        <mat-error *ngIf="form.get('StockMinimo')?.hasError('pattern') || form.get('StockMinimo')?.hasError('min')">
          Debe ser un número entero (0 o más).
        </mat-error>
      </mat-form-field>
      
      <mat-form-field appearance="fill">
        <mat-label>Precio Base (Lote)</mat-label>
        <input matInput type="number" formControlName="PrecioBase">
        <span matTextPrefix>$&nbsp;</span>
        <mat-error *ngIf="form.get('PrecioBase')?.hasError('required')">
          Requerido.
        </mat-error>
        <mat-error *ngIf="form.get('PrecioBase')?.hasError('pattern') || form.get('PrecioBase')?.hasError('max')">
          Precio inválido (Máx: 99999999.99).
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill" class="costo-distribuido-field">
        <mat-label>Costo Adicional (Lote)</mat-label>
        <input matInput type="number" formControlName="CostoDistribuido">
        <span matTextPrefix>$&nbsp;</span>
        <mat-error *ngIf="form.get('CostoDistribuido')?.hasError('pattern') || form.get('CostoDistribuido')?.hasError('max')">
          Costo inválido (Máx: 99999999.99).
        </mat-error>
      </mat-form-field>
      
      <mat-form-field appearance="fill" class="full-width-field">
        <mat-label>Comentarios</mat-label>
        <textarea matInput formControlName="ComentarioInsumo" placeholder="Detalles adicionales..." cdkTextareaAutosize cdkAutosizeMinRows="1"></textarea>
        <mat-error *ngIf="form.get('ComentarioInsumo')?.hasError('maxlength')">
          Comentario muy largo (Máx: 10,000 caracteres).
        </mat-error>
      </mat-form-field>

    </div>
  </mat-card-content>

  <mat-card-actions class="card-footer">
    <h4>
      Costo Final de Ingreso (Lote):
      <strong>{{ costoFinalIngreso | currency }}</strong>
    </h4>
  </mat-card-actions>
</mat-card>